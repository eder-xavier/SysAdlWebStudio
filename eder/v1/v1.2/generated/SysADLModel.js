// Generated by SysADL Transformer v0.3 - Enhanced Architecture
// Features: Simplified activity keys, explicit references, lazy loading

const { Model, Component, Port, SimplePort, CompositePort, Connector, Activity, Action, Enum, Int, Boolean, String, Real, Void, valueType, dataType, dimension, unit, Constraint, Executable } = require('../sysadl-framework/SysADLBase');

// Types
const DM_types_Temperature = dimension('Temperature');
const UN_types_Celsius = unit('Celsius');
const UN_types_Fahrenheit = unit('Fahrenheit');
const VT_types_temperature = valueType('temperature', { extends: Real, dimension: DM_types_Temperature });
const VT_types_FahrenheitTemperature = valueType('FahrenheitTemperature', { extends: VT_types_temperature, unit: UN_types_Fahrenheit, dimension: DM_types_Temperature });
const VT_types_CelsiusTemperature = valueType('CelsiusTemperature', { extends: VT_types_temperature, unit: UN_types_Celsius, dimension: DM_types_Temperature });
const EN_types_Command = new Enum("On", "Off");
const DT_types_Commands = dataType('Commands', { heater: EN_types_Command, cooler: EN_types_Command });
const types = {
  Command: EN_types_Command,
  Commands: DT_types_Commands,
  temperature: VT_types_temperature,
  FahrenheitTemperature: VT_types_FahrenheitTemperature,
  CelsiusTemperature: VT_types_CelsiusTemperature,
  Celsius: UN_types_Celsius,
  Fahrenheit: UN_types_Fahrenheit
};

// Ports
class PT_Ports_FTemperatureOPT extends SimplePort {
  constructor(name, opts = {}) {
    super(name, "out", { ...{ expectedType: "FahrenheitTemperature" }, ...opts });
  }
}
class PT_Ports_PresenceIPT extends SimplePort {
  constructor(name, opts = {}) {
    super(name, "in", { ...{ expectedType: "Boolean" }, ...opts });
  }
}
class PT_Ports_PresenceOPT extends SimplePort {
  constructor(name, opts = {}) {
    super(name, "out", { ...{ expectedType: "Boolean" }, ...opts });
  }
}
class PT_Ports_CTemperatureIPT extends SimplePort {
  constructor(name, opts = {}) {
    super(name, "in", { ...{ expectedType: "CelsiusTemperature" }, ...opts });
  }
}
class PT_Ports_CommandIPT extends SimplePort {
  constructor(name, opts = {}) {
    super(name, "in", { ...{ expectedType: "Command" }, ...opts });
  }
}
class PT_Ports_CommandOPT extends SimplePort {
  constructor(name, opts = {}) {
    super(name, "out", { ...{ expectedType: "Command" }, ...opts });
  }
}
class PT_Ports_CTemperatureOPT extends SimplePort {
  constructor(name, opts = {}) {
    super(name, "out", { ...{ expectedType: "CelsiusTemperature" }, ...opts });
  }
}

// Connectors
class CN_Connectors_FahrenheitToCelsiusCN extends Connector {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      activityName: "FahrenheitToCelsiusAC",
      participantSchema: {
        Ft: {
          portClass: 'PT_Ports_FTemperatureOPT',
          direction: 'out',
          dataType: 'FahrenheitTemperature',
          role: 'source'
        },
        Ct: {
          portClass: 'PT_Ports_CTemperatureIPT',
          direction: 'out',
          dataType: 'FahrenheitTemperature',
          role: 'target'
        }
      },
      flowSchema: [
        {
          from: 'Ft',
          to: 'Ct',
          dataType: 'FahrenheitTemperature'
        }
      ]
    });
  }
}
class CN_Connectors_PresenceCN extends Connector {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      participantSchema: {
        pOut: {
          portClass: 'PT_Ports_PresenceOPT',
          direction: 'out',
          dataType: 'Boolean',
          role: 'source'
        },
        pIn: {
          portClass: 'PT_Ports_PresenceIPT',
          direction: 'out',
          dataType: 'Boolean',
          role: 'target'
        }
      },
      flowSchema: [
        {
          from: 'pOut',
          to: 'pIn',
          dataType: 'Boolean'
        }
      ]
    });
  }
}
class CN_Connectors_CommandCN extends Connector {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      participantSchema: {
        commandOut: {
          portClass: 'PT_Ports_CommandOPT',
          direction: 'out',
          dataType: 'Command',
          role: 'source'
        },
        commandIn: {
          portClass: 'PT_Ports_CommandIPT',
          direction: 'out',
          dataType: 'Command',
          role: 'target'
        }
      },
      flowSchema: [
        {
          from: 'commandOut',
          to: 'commandIn',
          dataType: 'Command'
        }
      ]
    });
  }
}
class CN_Connectors_CTemperatureCN extends Connector {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      participantSchema: {
        CtOut: {
          portClass: 'PT_Ports_CTemperatureOPT',
          direction: 'out',
          dataType: 'CelsiusTemperature',
          role: 'source'
        },
        ctIn: {
          portClass: 'PT_Ports_CTemperatureIPT',
          direction: 'out',
          dataType: 'CelsiusTemperature',
          role: 'target'
        }
      },
      flowSchema: [
        {
          from: 'CtOut',
          to: 'ctIn',
          dataType: 'CelsiusTemperature'
        }
      ]
    });
  }
}

// Components
class CP_Components_TemperatureSensorCP extends Component {
  constructor(name, opts={}) {
      super(name, { ...opts, isBoundary: true });
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_current = portAliases["current"] || "current";
      this.addPort(new PT_Ports_FTemperatureOPT(portName_current, { owner: name, originalName: "current" }));
    }
}
class CP_Components_PresenceSensorCP extends Component {
  constructor(name, opts={}) {
      super(name, { ...opts, isBoundary: true });
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_detected = portAliases["detected"] || "detected";
      this.addPort(new PT_Ports_PresenceOPT(portName_detected, { owner: name, originalName: "detected" }));
    }
}
class CP_Components_UserInterfaceCP extends Component {
  constructor(name, opts={}) {
      super(name, { ...opts, isBoundary: true });
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_desired = portAliases["desired"] || "desired";
      this.addPort(new PT_Ports_CTemperatureOPT(portName_desired, { owner: name, originalName: "desired" }));
    }
}
class CP_Components_CoolerCP extends Component {
  constructor(name, opts={}) {
      super(name, { ...opts, isBoundary: true });
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_controllerC = portAliases["controllerC"] || "controllerC";
      this.addPort(new PT_Ports_CommandIPT(portName_controllerC, { owner: name, originalName: "controllerC" }));
    }
}
class CP_Components_HeaterCP extends Component {
  constructor(name, opts={}) {
      super(name, { ...opts, isBoundary: true });
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_controllerH = portAliases["controllerH"] || "controllerH";
      this.addPort(new PT_Ports_CommandIPT(portName_controllerH, { owner: name, originalName: "controllerH" }));
    }
}
class CP_Components_RoomTemperatureControllerCP extends Component {
  constructor(name, opts={}) {
      super(name, opts);
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_detectedRTC = portAliases["detectedRTC"] || "detectedRTC";
      this.addPort(new PT_Ports_PresenceIPT(portName_detectedRTC, { owner: name, originalName: "detectedRTC" }));
      const portName_localTemp1 = portAliases["localTemp1"] || "localTemp1";
      this.addPort(new PT_Ports_CTemperatureIPT(portName_localTemp1, { owner: name, originalName: "localTemp1" }));
      const portName_localTemp2 = portAliases["localTemp2"] || "localTemp2";
      this.addPort(new PT_Ports_CTemperatureIPT(portName_localTemp2, { owner: name, originalName: "localTemp2" }));
      const portName_userTempRTC = portAliases["userTempRTC"] || "userTempRTC";
      this.addPort(new PT_Ports_CTemperatureIPT(portName_userTempRTC, { owner: name, originalName: "userTempRTC" }));
      const portName_heatingRTC = portAliases["heatingRTC"] || "heatingRTC";
      this.addPort(new PT_Ports_CommandOPT(portName_heatingRTC, { owner: name, originalName: "heatingRTC" }));
      const portName_coolingRTC = portAliases["coolingRTC"] || "coolingRTC";
      this.addPort(new PT_Ports_CommandOPT(portName_coolingRTC, { owner: name, originalName: "coolingRTC" }));
    }
}
class CP_Components_SensorsMonitorCP extends Component {
  constructor(name, opts={}) {
      super(name, { ...opts, activityName: "CalculateAverageTemperatureAC" });
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_s1 = portAliases["s1"] || "s1";
      this.addPort(new PT_Ports_CTemperatureIPT(portName_s1, { owner: name, originalName: "s1" }));
      const portName_s2 = portAliases["s2"] || "s2";
      this.addPort(new PT_Ports_CTemperatureIPT(portName_s2, { owner: name, originalName: "s2" }));
      const portName_average = portAliases["average"] || "average";
      this.addPort(new PT_Ports_CTemperatureOPT(portName_average, { owner: name, originalName: "average" }));
    }
}
class CP_Components_CommanderCP extends Component {
  constructor(name, opts={}) {
      super(name, { ...opts, activityName: "DecideCommandAC" });
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_target2 = portAliases["target2"] || "target2";
      this.addPort(new PT_Ports_CTemperatureIPT(portName_target2, { owner: name, originalName: "target2" }));
      const portName_average2 = portAliases["average2"] || "average2";
      this.addPort(new PT_Ports_CTemperatureIPT(portName_average2, { owner: name, originalName: "average2" }));
      const portName_heating = portAliases["heating"] || "heating";
      this.addPort(new PT_Ports_CommandOPT(portName_heating, { owner: name, originalName: "heating" }));
      const portName_cooling = portAliases["cooling"] || "cooling";
      this.addPort(new PT_Ports_CommandOPT(portName_cooling, { owner: name, originalName: "cooling" }));
    }
}
class CP_Components_PresenceCheckerCP extends Component {
  constructor(name, opts={}) {
      super(name, { ...opts, activityName: "CheckPresenceToSetTemperatureAC" });
      // Add ports from component definition
      const portAliases = opts.portAliases || {};
      const portName_detected = portAliases["detected"] || "detected";
      this.addPort(new PT_Ports_PresenceIPT(portName_detected, { owner: name, originalName: "detected" }));
      const portName_userTemp = portAliases["userTemp"] || "userTemp";
      this.addPort(new PT_Ports_CTemperatureIPT(portName_userTemp, { owner: name, originalName: "userTemp" }));
      const portName_target = portAliases["target"] || "target";
      this.addPort(new PT_Ports_CTemperatureOPT(portName_target, { owner: name, originalName: "target" }));
    }
}
class CP_Components_RTCSystemCFD extends Component { }

// ===== Behavioral Element Classes =====
// Activity class: CalculateAverageTemperatureAC
class AC_Components_CalculateAverageTemperatureAC extends Activity {
  constructor(name, component = null, inputPorts = [], delegates = [], opts = {}) {
    super(name, component, inputPorts, delegates, {
      ...opts,
      inParameters: [{"name":"s1","type":"CelsiusTemperature","direction":"in"},{"name":"s2","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"average","type":"CelsiusTemperature","direction":"out"}]
    });
  }
}

// Activity class: CheckPresenceToSetTemperatureAC
class AC_Components_CheckPresenceToSetTemperatureAC extends Activity {
  constructor(name, component = null, inputPorts = [], delegates = [], opts = {}) {
    super(name, component, inputPorts, delegates, {
      ...opts,
      inParameters: [{"name":"detected","type":"Boolean","direction":"in"},{"name":"userTemp","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"target","type":"CelsiusTemperature","direction":"out"}]
    });
  }
}

// Activity class: DecideCommandAC
class AC_Components_DecideCommandAC extends Activity {
  constructor(name, component = null, inputPorts = [], delegates = [], opts = {}) {
    super(name, component, inputPorts, delegates, {
      ...opts,
      inParameters: [{"name":"average2","type":"CelsiusTemperature","direction":"in"},{"name":"target2","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"cooling","type":"Command","direction":"out"},{"name":"heating","type":"Command","direction":"out"}]
    });
  }
}

// Activity class: FahrenheitToCelsiusAC
class AC_Components_FahrenheitToCelsiusAC extends Activity {
  constructor(name, component = null, inputPorts = [], delegates = [], opts = {}) {
    super(name, component, inputPorts, delegates, {
      ...opts,
      inParameters: [{"name":"current1","type":"FahrenheitTemperature","direction":"in"}],
      outParameters: [{"name":"localTemp1","type":"CelsiusTemperature","direction":"out"}]
    });
  }
}

// Action class: CalculateAverageTemperatureAN
class AN_Components_CalculateAverageTemperatureAN extends Action {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"t1","type":"CelsiusTemperature","direction":"in"},{"name":"t2","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"CalculateAverageTemperatureAN","type":"CelsiusTemperature","direction":"out"}],
      constraints: ["CalculateAverageTemperatureEQ"],
      executables: ["CalculateAverageTemperatureEx"],
    });
  }
}

// Action class: CompareTemperatureAN
class AN_Components_CompareTemperatureAN extends Action {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"average2","type":"CelsiusTemperature","direction":"in"},{"name":"target2","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"CompareTemperatureAN","type":"Commands","direction":"out"}],
      constraints: ["CompareTemperatureEQ"],
      executables: ["CompareTemperatureEx"],
    });
  }
}

// Action class: CommandHeaterAN
class AN_Components_CommandHeaterAN extends Action {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"cmds","type":"Commands","direction":"in"}],
      outParameters: [{"name":"CommandHeaterAN","type":"Command","direction":"out"}],
      constraints: ["CommandHeaterEQ"],
      executables: ["CommandHeaterEx"],
    });
  }
}

// Action class: CommandCoolerAN
class AN_Components_CommandCoolerAN extends Action {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"cmds","type":"Commands","direction":"in"}],
      outParameters: [{"name":"CommandCoolerAN","type":"Command","direction":"out"}],
      constraints: ["CommandCoolerEQ"],
      executables: ["CommandCoolerEx"],
    });
  }
}

// Action class: FahrenheitToCelsiusAN
class AN_Components_FahrenheitToCelsiusAN extends Action {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"current1","type":"FahrenheitTemperature","direction":"in"}],
      outParameters: [{"name":"FahrenheitToCelsiusAN","type":"CelsiusTemperature","direction":"out"}],
      constraints: ["FahrenheitToCelsiusEQ"],
      executables: ["FahrenheitToCelsiusEx"],
    });
  }
}

// Action class: CheckPresenceToSetTemperatureAN
class AN_Components_CheckPresenceToSetTemperatureAN extends Action {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"detected","type":"Boolean","direction":"in"},{"name":"userTemp","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"CheckPresenceToSetTemperatureAN","type":"CelsiusTemperature","direction":"out"}],
      constraints: ["CheckPresenceToSetTemperatureEQ"],
      executables: ["CheckPresenceToSetTemperature"],
    });
  }
}

// Constraint class: CalculateAverageTemperatureEQ
class CT_Components_CalculateAverageTemperatureEQ extends Constraint {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"t1","type":"CelsiusTemperature","direction":"in"},{"name":"t2","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"av","type":"CelsiusTemperature","direction":"out"}],
      equation: "(av == ((t1 + t2) / 2))",
      constraintFunction: function(params) {// Constraint equation: (av == ((t1 + t2) / 2))
          const { t1, t2 } = params;
          
          // Type validation
          // Type validation for t1: CelsiusTemperature (no validation implemented)
          // Type validation for t2: CelsiusTemperature (no validation implemented)
          return av == ((t1 + t2) / 2);
        }
    });
  }
}

// Constraint class: CompareTemperatureEQ
class CT_Components_CompareTemperatureEQ extends Constraint {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"target2","type":"CelsiusTemperature","direction":"in"},{"name":"average2","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"cmds","type":"Commands","direction":"out"}],
      equation: "((average2 > target2) ? ((cmds == types.Commands.heater.Off) && types.Commands.cooler.On) : (types.Commands.heater.On && (cmds == types.Commands.cooler.Off)))",
      constraintFunction: function(params) {// Conditional constraint: ((average2 > target2) ? ((cmds == types.Commands.heater.Off) && types.Commands.cooler.On) : (types.Commands.heater.On && (cmds == types.Commands.cooler.Off)))
          const { average2, target2, cmds, heater, cooler } = params;
          
          // Type validation
          if (typeof average2 !== 'number') throw new Error('Parameter average2 must be a Real (number)');
          if (typeof target2 !== 'number') throw new Error('Parameter target2 must be a Real (number)');
          if (typeof cmds !== 'number') throw new Error('Parameter cmds must be a Real (number)');
          if (typeof heater !== 'number') throw new Error('Parameter heater must be a Real (number)');
          if (typeof cooler !== 'number') throw new Error('Parameter cooler must be a Real (number)');
          return (average2 > target2) ? ((cmds == types.Commands.heater.Off) && types.Commands.cooler.On) : (types.Commands.heater.On && (cmds == types.Commands.cooler.Off));
        }
    });
  }
}

// Constraint class: FahrenheitToCelsiusEQ
class CT_Components_FahrenheitToCelsiusEQ extends Constraint {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"f","type":"FahrenheitTemperature","direction":"in"}],
      outParameters: [{"name":"c","type":"CelsiusTemperature","direction":"out"}],
      equation: "(c == ((5 * (f - 32)) / 9))",
      constraintFunction: function(params) {// Constraint equation: (c == ((5 * (f - 32)) / 9))
          const { f } = params;
          
          // Type validation
          // Type validation for f: FahrenheitTemperature (no validation implemented)
          return c == ((5 * (f - 32)) / 9);
        }
    });
  }
}

// Constraint class: CommandHeaterEQ
class CT_Components_CommandHeaterEQ extends Constraint {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"cmds","type":"Commands","direction":"in"}],
      outParameters: [{"name":"c","type":"Command","direction":"out"}],
      equation: "(c == cmds.heater)",
      constraintFunction: function(params) {// Constraint equation: (c == cmds.heater)
          const { cmds, heater } = params;
          
          // Type validation
          // Type validation for cmds: Commands (no validation implemented)
          if (typeof heater !== 'number') throw new Error('Parameter heater must be a Real (number)');
          return c == cmds.heater;
        }
    });
  }
}

// Constraint class: CommandCoolerEQ
class CT_Components_CommandCoolerEQ extends Constraint {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"cmds","type":"Commands","direction":"in"}],
      outParameters: [{"name":"c","type":"Command","direction":"out"}],
      equation: "(c == cmds.cooler)",
      constraintFunction: function(params) {// Constraint equation: (c == cmds.cooler)
          const { cmds, cooler } = params;
          
          // Type validation
          // Type validation for cmds: Commands (no validation implemented)
          if (typeof cooler !== 'number') throw new Error('Parameter cooler must be a Real (number)');
          return c == cmds.cooler;
        }
    });
  }
}

// Constraint class: CheckPresenceToSetTemperatureEQ
class CT_Components_CheckPresenceToSetTemperatureEQ extends Constraint {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"detected","type":"Boolean","direction":"in"},{"name":"userTemp","type":"CelsiusTemperature","direction":"in"}],
      outParameters: [{"name":"target","type":"CelsiusTemperature","direction":"out"}],
      equation: "((detected == true) ? (target == userTemp) : (target == 2))",
      constraintFunction: function(params) {// Conditional constraint: ((detected == true) ? (target == userTemp) : (target == 2))
          const { detected, target, userTemp } = params;
          
          // Type validation
          if (typeof detected !== 'number') throw new Error('Parameter detected must be a Real (number)');
          if (typeof target !== 'number') throw new Error('Parameter target must be a Real (number)');
          if (typeof userTemp !== 'number') throw new Error('Parameter userTemp must be a Real (number)');
          return (detected == true) ? (target == userTemp) : (target == 2);
        }
    });
  }
}

// Executable class: CommandCoolerEx
class EX_Components_CommandCoolerEx extends Executable {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"cmds","type":"Commands","direction":"in"}],
      body: "executable def CommandCoolerEx(in cmds:Commands): out Command{return cmds->cooler ; }",
      executableFunction: function(params) {
          // Type validation
          // Type validation for cmds: (auto-detected from usage)
          const { cmds } = params;
          return cmds.cooler;
        }
    });
  }
}

// Executable class: CommandHeaterEx
class EX_Components_CommandHeaterEx extends Executable {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"cmds","type":"Commands","direction":"in"}],
      body: "executable def CommandHeaterEx(in cmds:Commands): out Command{return cmds->heater ; }",
      executableFunction: function(params) {
          // Type validation
          // Type validation for cmds: (auto-detected from usage)
          const { cmds } = params;
          return cmds.heater;
        }
    });
  }
}

// Executable class: FahrenheitToCelsiusEx
class EX_Components_FahrenheitToCelsiusEx extends Executable {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"f","type":"FahrenheitTemperature","direction":"in"}],
      body: "executable def FahrenheitToCelsiusEx(in f:FahrenheitTemperature): out CelsiusTemperature{return 5*(f - 32)/9 ; }",
      executableFunction: function(params) {
          // Type validation
          // Type validation for f: (auto-detected from usage)
          const { f } = params;
          return 5*(f - 32)/9;
        }
    });
  }
}

// Executable class: CalculateAverageTemperatureEx
class EX_Components_CalculateAverageTemperatureEx extends Executable {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"temp1","type":"CelsiusTemperature","direction":"in"},{"name":"temp2","type":"CelsiusTemperature","direction":"in"}],
      body: "executable def CalculateAverageTemperatureEx(in temp1:CelsiusTemperature,in temp2:CelsiusTemperature):out CelsiusTemperature{return (temp1 + temp2)/2 ; }",
      executableFunction: function(params) {
          // Type validation
          // Type validation for temp1: (auto-detected from usage)
          // Type validation for temp2: (auto-detected from usage)
          const { temp1, temp2 } = params;
          return (temp1 + temp2)/2;
        }
    });
  }
}

// Executable class: CheckPresenceToSetTemperature
class EX_Components_CheckPresenceToSetTemperature extends Executable {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"presence","type":"Boolean","direction":"in"},{"name":"userTemp","type":"CelsiusTemperature","direction":"in"}],
      body: "executable def CheckPresenceToSetTemperature(in presence:Boolean, in userTemp:CelsiusTemperature):out CelsiusTemperature{if(presence == true) return userTemp; else return 2; }",
      executableFunction: function(params) {
          // Type validation
          // Type validation for presence: (auto-detected from usage)
          // Type validation for userTemp: (auto-detected from usage)
          const { presence, userTemp } = params;
          if(presence == true) return userTemp; else return 2;
        }
    });
  }
}

// Executable class: CompareTemperatureEx
class EX_Components_CompareTemperatureEx extends Executable {
  constructor(name, opts = {}) {
    super(name, {
      ...opts,
      inParameters: [{"name":"target","type":"CelsiusTemperature","direction":"in"},{"name":"average","type":"CelsiusTemperature","direction":"in"}],
      body: "executable def CompareTemperatureEx(in target:CelsiusTemperature, in average:CelsiusTemperature):out Commands{let heater:Command = types.Command::Off; let cooler:Command = types.Command::Off; if(average > target) {heater = types.Command::Off; cooler = types.Command::On ; } else {heater = types.Command::On; cooler = types.Command::Off ;} }",
      executableFunction: function(params) {
          // Type validation
          // Type validation for target: (auto-detected from usage)
          // Type validation for average: (auto-detected from usage)
          const { target, average } = params;
          let heater = types.Command.Off; let cooler = types.Command.Off; if(average > target) {heater = types.Command.Off; cooler = types.Command.On ; } else {heater = types.Command.On; cooler = types.Command.Off ;}
return {heater: heater, cooler: cooler};
        }
    });
  }
}

// ===== End Behavioral Element Classes =====

class SysADLModel extends Model {
  constructor(){
    super("SysADLModel");
    this.RTCSystemCFD = new CP_Components_RTCSystemCFD("RTCSystemCFD", { sysadlDefinition: "RTCSystemCFD" });
    this.addComponent(this.RTCSystemCFD);
    this.RTCSystemCFD.a1 = new CP_Components_HeaterCP("a1", { isBoundary: true, sysadlDefinition: "HeaterCP", portAliases: {"controllerH":"controllerH"} });
    this.RTCSystemCFD.addComponent(this.RTCSystemCFD.a1);
    this.RTCSystemCFD.a2 = new CP_Components_CoolerCP("a2", { isBoundary: true, sysadlDefinition: "CoolerCP", portAliases: {"controllerC":"controllerC"} });
    this.RTCSystemCFD.addComponent(this.RTCSystemCFD.a2);
    this.RTCSystemCFD.rtc = new CP_Components_RoomTemperatureControllerCP("rtc", { sysadlDefinition: "RoomTemperatureControllerCP", portAliases: {"detectedRTC":"detected"} });
    this.RTCSystemCFD.addComponent(this.RTCSystemCFD.rtc);
    this.RTCSystemCFD.s1 = new CP_Components_TemperatureSensorCP("s1", { isBoundary: true, sysadlDefinition: "TemperatureSensorCP", portAliases: {"current":"current1"} });
    this.RTCSystemCFD.addComponent(this.RTCSystemCFD.s1);
    this.RTCSystemCFD.s2 = new CP_Components_TemperatureSensorCP("s2", { isBoundary: true, sysadlDefinition: "TemperatureSensorCP", portAliases: {"current":"current2"} });
    this.RTCSystemCFD.addComponent(this.RTCSystemCFD.s2);
    this.RTCSystemCFD.s3 = new CP_Components_PresenceSensorCP("s3", { isBoundary: true, sysadlDefinition: "PresenceSensorCP", portAliases: {"detected":"detectedS"} });
    this.RTCSystemCFD.addComponent(this.RTCSystemCFD.s3);
    this.RTCSystemCFD.ui = new CP_Components_UserInterfaceCP("ui", { isBoundary: true, sysadlDefinition: "UserInterfaceCP", portAliases: {"desired":"desired"} });
    this.RTCSystemCFD.addComponent(this.RTCSystemCFD.ui);
    this.RTCSystemCFD.rtc.cm = new CP_Components_CommanderCP("cm", { sysadlDefinition: "CommanderCP", portAliases: {} });
    this.RTCSystemCFD.rtc.addComponent(this.RTCSystemCFD.rtc.cm);
    this.RTCSystemCFD.rtc.pc = new CP_Components_PresenceCheckerCP("pc", { sysadlDefinition: "PresenceCheckerCP", portAliases: {"detected":"detected","userTemp":"userTemp","target":"target"} });
    this.RTCSystemCFD.rtc.addComponent(this.RTCSystemCFD.rtc.pc);
    this.RTCSystemCFD.rtc.sm = new CP_Components_SensorsMonitorCP("sm", { sysadlDefinition: "SensorsMonitorCP", portAliases: {"average":"average"} });
    this.RTCSystemCFD.rtc.addComponent(this.RTCSystemCFD.rtc.sm);

    this.RTCSystemCFD.rtc.addConnector(new CN_Connectors_CTemperatureCN("target"));
    const target = this.RTCSystemCFD.rtc.connectors["target"];
    target.bind(this.RTCSystemCFD.rtc.pc.getPort("target"), this.RTCSystemCFD.rtc.cm.getPort("target2"));
    this.RTCSystemCFD.rtc.addConnector(new CN_Connectors_CTemperatureCN("average"));
    const average = this.RTCSystemCFD.rtc.connectors["average"];
    average.bind(this.RTCSystemCFD.rtc.sm.getPort("average"), this.RTCSystemCFD.rtc.cm.getPort("average2"));
    this.RTCSystemCFD.addConnector(new CN_Connectors_FahrenheitToCelsiusCN("c1"));
    const c1 = this.RTCSystemCFD.connectors["c1"];
    c1.bind(this.RTCSystemCFD.s1.getPort("current1"), this.RTCSystemCFD.rtc.getPort("localTemp1"));
    this.RTCSystemCFD.addConnector(new CN_Connectors_CTemperatureCN("uc"));
    const uc = this.RTCSystemCFD.connectors["uc"];
    uc.bind(this.RTCSystemCFD.ui.getPort("desired"), this.RTCSystemCFD.rtc.pc.getPort("userTemp"));
    this.RTCSystemCFD.addConnector(new CN_Connectors_CommandCN("cc2"));
    const cc2 = this.RTCSystemCFD.connectors["cc2"];
    cc2.bind(this.RTCSystemCFD.rtc.cm.getPort("cooling"), this.RTCSystemCFD.a2.getPort("controllerC"));
    this.RTCSystemCFD.addConnector(new CN_Connectors_PresenceCN("pc"));
    const pc = this.RTCSystemCFD.connectors["pc"];
    pc.bind(this.RTCSystemCFD.s3.getPort("detectedS"), this.RTCSystemCFD.rtc.getPort("detected"));
    this.RTCSystemCFD.addConnector(new CN_Connectors_FahrenheitToCelsiusCN("c2"));
    const c2 = this.RTCSystemCFD.connectors["c2"];
    c2.bind(this.RTCSystemCFD.s2.getPort("current2"), this.RTCSystemCFD.rtc.getPort("localTemp2"));
    this.RTCSystemCFD.addConnector(new CN_Connectors_CommandCN("cc1"));
    const cc1 = this.RTCSystemCFD.connectors["cc1"];
    cc1.bind(this.RTCSystemCFD.rtc.cm.getPort("heating"), this.RTCSystemCFD.a1.getPort("controllerH"));

    const ac_SensorsMonitorCP = new AC_Components_CalculateAverageTemperatureAC(
      "CalculateAverageTemperatureAC",
      "SensorsMonitorCP",
      [],
      [{"from":"s1","to":"s1"},{"from":"s2","to":"s2"},{"from":"average","to":"CalcAvTemp"}]
    );
    const CalcAvTemp = new AN_Components_CalculateAverageTemperatureAN("CalcAvTemp");
    ac_SensorsMonitorCP.registerAction(CalcAvTemp);
    this.registerActivity("CalculateAverageTemperatureAC", ac_SensorsMonitorCP);
    const ac_PresenceCheckerCP = new AC_Components_CheckPresenceToSetTemperatureAC(
      "CheckPresenceToSetTemperatureAC",
      "PresenceCheckerCP",
      [],
      [{"from":"detected","to":"detected"},{"from":"userTemp","to":"userTemp"},{"from":"target","to":"CheckPresenceToSetTemperatureAN"}]
    );
    const CheckPresenceToSetTemperatureAN_inst = new AN_Components_CheckPresenceToSetTemperatureAN("CheckPresenceToSetTemperatureAN");
    ac_PresenceCheckerCP.registerAction(CheckPresenceToSetTemperatureAN_inst);
    this.registerActivity("CheckPresenceToSetTemperatureAC", ac_PresenceCheckerCP);
    const ac_CommanderCP = new AC_Components_DecideCommandAC(
      "DecideCommandAC",
      "CommanderCP",
      [],
      [{"from":"average2","to":"average2"},{"from":"target2","to":"target2"},{"from":"heating","to":"cmdH"},{"from":"cooling","to":"cmdC"}]
    );
    const cmdC = new AN_Components_CommandCoolerAN("cmdC");
    ac_CommanderCP.registerAction(cmdC);
    const cmdH = new AN_Components_CommandHeaterAN("cmdH");
    ac_CommanderCP.registerAction(cmdH);
    const ct = new AN_Components_CompareTemperatureAN("ct");
    ac_CommanderCP.registerAction(ct);
    this.registerActivity("DecideCommandAC", ac_CommanderCP);
    const ac_FahrenheitToCelsiusCN = new AC_Components_FahrenheitToCelsiusAC(
      "FahrenheitToCelsiusAC",
      "FahrenheitToCelsiusCN",
      [],
      [{"from":"current1","to":"Ft"},{"from":"localTemp1","to":"Ct"}]
    );
    const FtC = new AN_Components_FahrenheitToCelsiusAN("FtC");
    ac_FahrenheitToCelsiusCN.registerAction(FtC);
    this.registerActivity("FahrenheitToCelsiusAC", ac_FahrenheitToCelsiusCN);
  }

}

function createModel(){ 
  const model = new SysADLModel();
  
  model.typeRegistry = {
    'temperature': 'VT_types_temperature',
    'FahrenheitTemperature': 'VT_types_FahrenheitTemperature',
    'CelsiusTemperature': 'VT_types_CelsiusTemperature',
    'Command': 'EN_types_Command',
  };
  
  // Module context for class resolution
  model._moduleContext = {
    PT_Ports_FTemperatureOPT,
    PT_Ports_PresenceIPT,
    PT_Ports_PresenceOPT,
    PT_Ports_CTemperatureIPT,
    PT_Ports_CommandIPT,
    PT_Ports_CommandOPT,
    PT_Ports_CTemperatureOPT,
    CN_Connectors_FahrenheitToCelsiusCN,
    CN_Connectors_PresenceCN,
    CN_Connectors_CommandCN,
    CN_Connectors_CTemperatureCN,
    CT_Components_CalculateAverageTemperatureEQ,
    CT_Components_CompareTemperatureEQ,
    CT_Components_FahrenheitToCelsiusEQ,
    CT_Components_CommandHeaterEQ,
    CT_Components_CommandCoolerEQ,
    CT_Components_CheckPresenceToSetTemperatureEQ,
    EX_Components_CommandCoolerEx,
    EX_Components_CommandHeaterEx,
    EX_Components_FahrenheitToCelsiusEx,
    EX_Components_CalculateAverageTemperatureEx,
    EX_Components_CheckPresenceToSetTemperature,
    EX_Components_CompareTemperatureEx,
    EN_types_Command,
    DT_types_Commands,
    VT_types_temperature,
    VT_types_FahrenheitTemperature,
    VT_types_CelsiusTemperature,
    UN_types_Celsius,
    UN_types_Fahrenheit,
  };
  
  // Initialize all connectors now that _moduleContext is available
  model.initializeAllConnectors();
  
  // Resolve constraints and executables for all registered activities
  Object.values(model._activities || {}).forEach(activity => {
    if (activity && activity.actions) {
      activity.actions.forEach(action => {
        if (action.constraintNames && action.constraintNames.length > 0) {
          action.resolveConstraints(model._moduleContext);
        }
        if (action.executableNames && action.executableNames.length > 0) {
          action.resolveExecutables(model._moduleContext);
        }
      });
    }
  });
  
  return model;
}

module.exports = { createModel, SysADLModel, VT_types_temperature, VT_types_FahrenheitTemperature, VT_types_CelsiusTemperature, EN_types_Command, DT_types_Commands, DM_types_Temperature, UN_types_Celsius, UN_types_Fahrenheit, PT_Ports_FTemperatureOPT, PT_Ports_PresenceIPT, PT_Ports_PresenceOPT, PT_Ports_CTemperatureIPT, PT_Ports_CommandIPT, PT_Ports_CommandOPT, PT_Ports_CTemperatureOPT };