<!DOCTYPE html>
<html>
<head>
    <title>Teste Simulador Simple Model</title>
</head>
<body>
    <h1>Teste do Novo Simulador - Modelo Simples</h1>
    <div id="output"></div>
    
    <script src="./sysadl-framework/SysADLBase.js"></script>
    <script src="./simulator.js"></script>
    <script src="./transformer.js"></script>
    
    <script>
        console.log('üß™ Testando novo simulador com modelo simples...');
        
        // Modelo SysADL simples para teste
        const simpleModel = `model TestModel
configuration {
  component Sensor s1;
  component Display d1;
}`;
        
        console.log('üìù Modelo SysADL:', simpleModel);
        
        try {
            // Parse do modelo
            const ast = window.SysADLParser.parse(simpleModel);
            console.log('‚úÖ Parse bem-sucedido');
            
            // Transformar para JS
            const T = window.Transformer;
            const js = T.generateClassModule(
                'TestModel',
                [], // compUses
                [], // portUses  
                [], // connectorBindings
                [], // executables
                [], // activitiesToRegister
                [], // rootDefs
                {}, // parentMap
                {}, // compInstanceDef
                {}, // compDefMap
                {}, // portDefMap
                {}, // embeddedTypes
                {}, // connectorDefMap
                {}, // packageMap
                ast
            );
            
            console.log('‚úÖ Transforma√ß√£o bem-sucedida');
            console.log('üìÑ JS gerado (primeiros 200 chars):', js.substring(0, 200));
            
            // Testar simula√ß√£o
            const S = window.Simulator;
            if (!S) {
                throw new Error('‚ùå window.Simulator n√£o encontrado');
            }
            
            console.log('üöÄ Iniciando simula√ß√£o...');
            const result = S.run(js);
            console.log('‚úÖ Simula√ß√£o conclu√≠da');
            console.log('üìä Resultado:', result);
            
            document.getElementById('output').innerHTML = `
                <h2>‚úÖ Teste Conclu√≠do com Sucesso!</h2>
                <h3>Resultado da Simula√ß√£o:</h3>
                <pre style="background: #f0f0f0; padding: 10px; border-radius: 5px;">${result}</pre>
                <h3>C√≥digo JS Gerado (primeiros 500 chars):</h3>
                <pre style="background: #e0e0e0; padding: 10px; border-radius: 5px;">${js.substring(0, 500)}...</pre>
            `;
            
        } catch (error) {
            console.error('‚ùå Erro no teste:', error);
            document.getElementById('output').innerHTML = `
                <h2>‚ùå Erro no Teste</h2>
                <p style="color: red;"><strong>Erro:</strong> ${error.message}</p>
                <pre style="background: #ffe0e0; padding: 10px; border-radius: 5px;">${error.stack || 'Stack trace n√£o dispon√≠vel'}</pre>
            `;
        }
    </script>
</body>
</html>